<!DOCTYPE html>
<html lang="vi">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  <title>Cá»­a hÃ ng Mini Order</title>
Â  <link rel="stylesheet" href="style.css" />
Â  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
Â  <style>
Â  Â  /* CSS ná»™i bá»™ cho danh sÃ¡ch sáº£n pháº©m (giá»¯ nguyÃªn Ä‘á»™ Ä‘áº¹p) */
Â  Â  .container { max-width: 1200px; margin: 80px auto 20px; padding: 20px; } /* CÃ¡ch top 80px Ä‘á»ƒ trÃ¡nh Ä‘Ã¨ menu */
Â  Â  .product-card {
Â  Â  Â  Â  display: flex; flex-direction: column; justify-content: space-between;
Â  Â  Â  Â  height: 100%; min-height: 280px; transition: transform 0.2s;
Â  Â  Â  Â  border: 1px solid #e0e0e0; /* ThÃªm border nháº¹ */
Â  Â  Â  Â  border-radius: 8px; /* Bo gÃ³c */
Â  Â  Â  Â  padding: 15px; /* ThÃªm padding */
Â  Â  }
Â  Â  .product-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
Â  Â  .product-name { font-size: 1.2em; font-weight: bold; margin-bottom: 5px; color: #2c3e50; }
Â  Â  .product-desc { color: #7f8c8d; font-size: 0.9em; margin-bottom: 15px; flex-grow: 1; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
Â  Â  .price-tag { font-size: 1.3em; color: #e74c3c; font-weight: bold; }
Â  Â  .stock-tag { font-size: 0.85em; color: #27ae60; background: #e8f8f5; padding: 3px 8px; border-radius: 4px; }
Â  Â  .stock-out { color: #c0392b; font-weight: bold; background: #fadbd8; padding: 3px 8px; border-radius: 4px; }
    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
    }
    /* ThÃªm style cho nÃºt */
    .product-meta button {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 10px;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s;
    }
    .product-meta button:hover:not(:disabled) {
        background-color: #0056b3;
    }
    .product-meta button:disabled {
        background-color: #ccc;
        cursor: not-allowed;
    }
Â  </style>
</head>
<body>

Â  <nav class="navbar">
Â  Â  <div class="nav-brand" onclick="location.href='products.html'">
Â  Â  Â  Â ğŸ›’ Mini Order
Â  Â  </div>
Â  Â  
Â  Â  <div class="nav-links">
Â  Â  Â  Â  <a href="products.html" class="active">Sáº£n pháº©m</a>
Â  Â  Â  Â  <a href="cart.html" class="cart-btn">
Â  Â  Â  Â  Â  Â  Giá» hÃ ng <span class="badge" id="cart-count">0</span>
Â  Â  Â  Â  </a>
Â  Â  Â  Â  <div class="user-menu">
Â  Â  Â  Â  Â  Â  <span id="user-display">KhÃ¡ch</span>
Â  Â  Â  Â  Â  Â  <button onclick="logout()" class="btn-logout">ÄÄƒng xuáº¥t</button>
Â  Â  Â  Â  </div>
Â  Â  </div>
Â  </nav>

Â  <div class="container" style="box-shadow:none; background:transparent;">
Â  Â  Â  <h2 style="margin-bottom: 20px; border-left: 5px solid #007bff; padding-left: 10px; color: #333;">
Â  Â  Â  Â  Â  Danh sÃ¡ch sáº£n pháº©m má»›i nháº¥t
Â  Â  Â  </h2>

Â  Â  Â  <div id="products-list" class="grid">
Â  Â  Â  Â  <p style="text-align:center; grid-column: 1/-1;">Äang táº£i dá»¯ liá»‡u...</p>
Â  Â  Â  </div>
Â  </div>

Â  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
Â  <script src="script.js"></script>
Â  <script>
    // --- Bá»• sung cÃ¡c biáº¿n vÃ  hÃ m cáº§n thiáº¿t Ä‘á»ƒ cháº¡y Ä‘á»™c láº­p ---
    // Giáº£ láº­p API_URL náº¿u chÆ°a Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong script.js
    const API_URL = window.API_URL || 'http://localhost:5194/api'; 
    // Máº£ng mÃ´ phá»ng giá» hÃ ng
    let cartItems = []; 
    
    // HÃ m cáº­p nháº­t sá»‘ lÆ°á»£ng sáº£n pháº©m trÃªn icon Giá» hÃ ng
    function updateCartCount() {
        const totalCount = cartItems.reduce((sum, item) => sum + item.quantity, 0);
        document.getElementById('cart-count').textContent = totalCount;
    }

    // HÃ m giáº£ láº­p ThÃªm vÃ o Giá» hÃ ng (dÃ¹ng Toastify)
    function addToCart(productId, name, price) {
        const existingItem = cartItems.find(item => item.id === productId);

        if (existingItem) {
            existingItem.quantity += 1;
        } else {
            cartItems.push({ id: productId, name: name, price: price, quantity: 1 });
        }
        
        updateCartCount();

        Toastify({
            text: `ÄÃ£ thÃªm 1 x ${name} vÃ o giá» hÃ ng!`,
            duration: 3000,
            close: true,
            gravity: "top",
            position: "right",
            backgroundColor: "linear-gradient(to right, #00b09b, #96c93d)",
        }).showToast();
    }
    
    // HÃ m giáº£ láº­p logout (dÃ¹ng Ä‘á»ƒ trÃ¡nh lá»—i)
    function logout() {
        localStorage.removeItem('token');
        localStorage.removeItem('username');
        window.location.href = 'login.html'; // Giáº£ Ä‘á»‹nh cÃ³ trang login
    }
    // HÃ m giáº£ láº­p checkAuth (dÃ¹ng Ä‘á»ƒ trÃ¡nh lá»—i)
    function checkAuth() {
        return localStorage.getItem('token') ? true : false;
    }

    // --- Danh sÃ¡ch 10 Sáº£n pháº©m cá»‘ Ä‘á»‹nh (hardcoded) ---
    const staticProducts = [
        { id: 1, name: "Ão PhÃ´ng Cotton", price: 200000, stockQuantity: 50, description: "Cháº¥t liá»‡u cotton 100%, thoÃ¡ng mÃ¡t, phÃ¹ há»£p mÃ¹a hÃ¨, nhiá»u mÃ u sáº¯c." },
        { id: 2, name: "Quáº§n Jeans Slim Fit", price: 500000, stockQuantity: 25, description: "Thiáº¿t káº¿ Ã´m vá»«a váº·n, co giÃ£n nháº¹, phong cÃ¡ch tráº» trung vÃ  nÄƒng Ä‘á»™ng." },
        { id: 3, name: "GiÃ y Thá»ƒ Thao Pro-X", price: 1200000, stockQuantity: 10, description: "Äáº¿ Ä‘á»‡m khÃ­, siÃªu nháº¹, lÃ½ tÆ°á»Ÿng cho cháº¡y bá»™ vÃ  hoáº¡t Ä‘á»™ng ngoÃ i trá»i." },
        { id: 4, name: "Äá»“ng Há»“ Smartwatch S2", price: 3500000, stockQuantity: 5, description: "Theo dÃµi sá»©c khá»e, pin trÃ¢u, chá»‘ng nÆ°á»›c tuyá»‡t Ä‘á»‘i, káº¿t ná»‘i Bluetooth." },
        { id: 5, name: "Balo Laptop Da PU", price: 650000, stockQuantity: 30, description: "Chá»©a laptop 15.6 inch, thiáº¿t káº¿ sang trá»ng, bá»n bá»‰ vÃ  chá»‘ng tháº¥m nÆ°á»›c." },
        { id: 6, name: "Tai Nghe KhÃ´ng DÃ¢y ANC", price: 890000, stockQuantity: 15, description: "Khá»­ tiáº¿ng á»“n chá»§ Ä‘á»™ng (ANC), Ã¢m thanh cháº¥t lÆ°á»£ng cao, sáº¡c nhanh USB-C." },
        { id: 7, name: "Sáº¡c Dá»± PhÃ²ng 10000mAh", price: 320000, stockQuantity: 0, description: "Cá»•ng sáº¡c nhanh USB-C, nhá» gá»n, tiá»‡n lá»£i mang theo. (Äang chá» nháº­p hÃ ng)." },
        { id: 8, name: "MÃ³c KhÃ³a Titan Äa NÄƒng", price: 50000, stockQuantity: 100, description: "Cháº¥t liá»‡u Titan siÃªu nháº¹, khÃ´ng gá»‰ sÃ©t, tÃ­ch há»£p má»Ÿ chai." },
        { id: 9, name: "BÃ n PhÃ­m CÆ¡ RK61", price: 950000, stockQuantity: 8, description: "KÃ­ch thÆ°á»›c 60%, Switch Red/Brown tÃ¹y chá»n, Ä‘Ã¨n RGB rá»±c rá»¡." },
        { id: 10, name: "Chuá»™t Gaming Logitech G102", price: 400000, stockQuantity: 40, description: "DPI lÃªn Ä‘áº¿n 8000, cáº£m biáº¿n chÃ­nh xÃ¡c, thiáº¿t káº¿ cÃ´ng thÃ¡i há»c hoÃ n háº£o." }
    ];

    // --- Thay tháº¿ hÃ m loadProducts cÅ© báº±ng hÃ m hiá»ƒn thá»‹ sáº£n pháº©m cá»‘ Ä‘á»‹nh ---
    function displayStaticProducts() {
        const products = staticProducts;
        
        const html = products.map(p => {
            const isOutOfStock = p.stockQuantity <= 0;
            const btnText = isOutOfStock ? 'Háº¿t hÃ ng' : 'ThÃªm vÃ o giá»';
            const stockText = isOutOfStock 
                ? '<span class="stock-out">Háº¿t hÃ ng</span>' 
                : `<span class="stock-tag">Kho: ${p.stockQuantity}</span>`;
            
            // Xá»­ lÃ½ tÃªn sáº£n pháº©m Ä‘á»ƒ truyá»n vÃ o JS an toÃ n
            const safeName = p.name.replace(/'/g, "\\'"); 

            return `
            <div class="product-card">
                <div>
                    <div style="height:150px; background:#ecf0f1; border-radius:8px; margin-bottom:10px; display:flex; align-items:center; justify-content:center; color:#bdc3c7;">
                        <span style="font-size:40px;">ğŸ“¦</span>
                    </div>
                    <div class="product-name">${p.name}</div>
                    <div class="product-desc">${p.description || "ChÆ°a cÃ³ mÃ´ táº£."}</div>
                </div>
                <div class="product-meta">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                        <span class="price-tag">${p.price.toLocaleString('vi-VN')}â‚«</span>
                        ${stockText}
                    </div>
                    <button onclick="addToCart(${p.id}, '${safeName}', ${p.price})" 
                        ${isOutOfStock ? 'disabled' : ''} style="width:100%;">
                        ${btnText}
                    </button>
                </div>
            </div>
            `;
        }).join('');
        
        document.getElementById('products-list').innerHTML = html;
    }
    
    // --- Logic khá»Ÿi táº¡o ---
    const auth = checkAuth(); 
    
    // Hiá»ƒn thá»‹ tÃªn user náº¿u cÃ³
    if (localStorage.getItem('username')) {
        document.getElementById('user-display').textContent = localStorage.getItem('username');
    }

    // Cháº¡y hÃ m hiá»ƒn thá»‹ sáº£n pháº©m cá»‘ Ä‘á»‹nh
    displayStaticProducts();
    
    // Cáº­p nháº­t sá»‘ lÆ°á»£ng giá» hÃ ng ban Ä‘áº§u (náº¿u cÃ³ lÆ°u trá»¯ local)
    updateCartCount(); 
Â  </script>
</body>
</html>